{# -*- coding: utf-8 -*-

  Copyright (C) 2021 Graz University of Technology.

  Invenio-Records-Marc21 is free software; you can redistribute it and/or modify it
  under the terms of the MIT License; see LICENSE file for more details.
#}

{%- extends config.MARC21_BASE_TEMPLATE %}


{%- from "invenio_records_marc21/records/macros/detail.html" import record_detail %}

{%- set metadata = record.metadata %}

{%- set marcrecord = record.metadata.json %}


{%- macro record_content(data) %}
  {% for key, value in data.items() recursive %}
    <li class="list-group-item">
    {% if value is mapping %}
        <strong>{{ key }}:</strong>
        <ul class="list-group">{{ loop(value.items()) }}</ul>
    {% elif value is iterable and value is not string %}
        <strong>{{ key }}:</strong>
        <ol>
        {% for item in value %}
          <li>
          {% if item is mapping %}
            <ul class="list-group">
              {{ record_content(item) }}
            </ul>
          {% else %}
            {{ item }}
          {% endif %}
          </li>
        {% endfor %}
        </ol>
    {% else %}
      <strong>{{ key }}:</strong> {{ value }}
    {% endif %}
    </li>
  {% endfor %}
{%- endmacro %}

{%- block page_body %}

<div class="ui container">
  <div class="ui relaxed grid">
    <div class="two column row top-padded">
      <div class="eleven wide column">
        {%- block record_body %}
        {%- block record_header -%}

        <div class="ui grid middle aligned">
          <div class="two column row">
            <div class="left floated left aligned column">
              <span class="ui" title="{{_('Creation date')}}">{{  record.created }}</span>
              {%- if record.revision_id %}
              <span class="label text-muted"> | Version {{ record.revision_id }}</span>
              {% endif %}
            </div>
          </div>
        </div>

        {%- endblock record_header -%}
        {%- block record_title -%}
          <h1>{{ record.metadata.json.title_statement.title | sanitize_title() }}</h1>
        {%- endblock record_title -%}
        {%- block record_content -%}
          <div class="right floated column">
            <span class="ui label access-right">
              <span class="icon lock open"></span>
              {{ record.access.access_right  | vocabulary_title('access_right') }}
              {%- for right in record.metadata.rights %}
              <a target="_blank" href="{{right.url}}">{{ '(' ~ right.identifier ~ ')' }}</a>
              {%- endfor %}

            </span>
          </div>

          {%- include "invenio_records_marc21/records/details/subjects.html" %}


        {%- endblock record_content -%}
        {%- block record_details -%}
        <!-- TODO: show details of record -->
        {%- endblock record_details -%}
        {%- block record_footer -%}

          <div class="ui grid">
            <div class="two column row top-bottom-padded font-small">
              <div class="four wide column">
                <p><b>Upload infromation</b></p>
              </div>
              <div class="twelve wide column">
                <span class="label text-muted">
                  <b>Created:</b> {{ record.created }} | <b>Modified:</b> {{ record.updated }}
                </span>
              </div>
            </div>
          </div>
        {%- endblock record_footer -%}
        {%- endblock record_body %} 
      </div>
    </div>
  </div>
</div>
{%- endblock page_body %}


{%- block javascript %}
{{ super() }}
{%- endblock javascript %}